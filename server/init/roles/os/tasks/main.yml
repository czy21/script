- name: valid
  assert:
    that: param_user_ops_ssh_public_key | trim != ""
    fail_msg: param_user_ops_ssh_public_key is empty

- name: mirror
  shell: |-
    bash {{ param_remote_role_path }}/mirror.sh
  when: param_mirror_use_proxy

- name: install
  shell: |-
    timedatectl set-timezone Asia/Shanghai
    bash {{ param_remote_role_path }}/{{ param_ansible_distribution }}.sh

- name: sshd_config
  shell: |-
    echo -n "
    UseDNS no
    PermitRootLogin yes
    PasswordAuthentication no
    ClientAliveInterval 30
    " > /etc/ssh/sshd_config.d/99-custom.conf