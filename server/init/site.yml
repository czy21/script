- name: os
  hosts: all
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
  vars:
    param_role_name: os
  pre_tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
  roles:
    - '{{ param_role_name }}'
  post_tasks:
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - '{{ param_role_name }}'

- name: containerd
  hosts: all
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
  vars:
    param_role_name: containerd
  pre_tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
  roles:
    - '{{ param_role_name }}'
  post_tasks:
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - '{{ param_role_name }}'

- name: docker
  hosts: all
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
  vars:
    param_role_name: docker
  pre_tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
  roles:
    - '{{ param_role_name }}'
  post_tasks:
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - '{{ param_role_name }}'

- name: k8s
  hosts: all
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
  vars:
    param_role_name: k8s
  pre_tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
  roles:
    - '{{ param_role_name }}'
  post_tasks:
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - '{{ param_role_name }}'

- name: k8s-master
  hosts: master
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
    - "roles/k8s/vars/main.yml"
  vars:
    param_role_name: k8s
  tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
    - include_tasks: roles/k8s/tasks/master.yml
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - 'k8s-master'

- name: k8s-worker
  hosts: worker
  vars_files:
    - "vars/env.yml"
    - "vars/main.yml"
    - "roles/k8s/vars/main.yml"
  vars:
    param_role_name: k8s
  tasks:
    - include_tasks: roles/common/tasks/copy-template.yml
    - include_tasks: roles/k8s/tasks/worker.yml
    - include_tasks: roles/common/tasks/cleanup.yml
  tags:
    - 'k8s-worker'