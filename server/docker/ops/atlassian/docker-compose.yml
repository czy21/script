version: '3.7'

services:
  jira:
    build:
      context: ${param_pwd_home}/compose/atlassian/
      dockerfile: ${param_pwd_home}/compose/atlassian/Dockerfile-Jira
    container_name: jira
    privileged: true
    user: root
    ports:
      - "8100:8080"
    volumes:
      - ${param_volumes_dir}/atlassian/jira/:/var/atlassian/jira/
      - ${param_volumes_dir}/atlassian/jira/logs:/opt/atlassian/jira/logs
    environment:
      TZ: Asia/Shanghai
      CATALINA_OPTS: "-Xmx2G"
    restart: always

  confluence:
    build:
      context: ${param_pwd_home}/compose/atlassian/
      dockerfile: ${param_pwd_home}/compose/atlassian/Dockerfile-Confluence
    container_name: confluence
    privileged: true
    user: root
    ports:
      - "8101:8090"
    volumes:
      - ${param_volumes_dir}/atlassian/confluence/:/var/atlassian/confluence/
      - ${param_volumes_dir}/atlassian/confluence/logs:/opt/atlassian/confluence/logs
    environment:
      TZ: Asia/Shanghai
      CATALINA_OPTS: "-Xmx2G"
    restart: always


networks:
  default:
    external:
      name: local
