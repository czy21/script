http:
  routers:
    apt-proxy:
      rule: "Host(`nexus.cluster.com`) && PathPrefix(`/repository/apt-proxy`)"
      service: nexus@docker
      middlewares:
        - apt-proxy
    yum-proxy:
      rule: "Host(`nexus.cluster.com`) && PathPrefix(`/repository/yum-proxy`)"
      service: nexus@docker
      middlewares:
        - yum-proxy-centos
        - yum-proxy-centos-vault

  middlewares:
    https-redirect:
      redirectScheme:
        scheme: https
        permanent: true
    apt-proxy:
      replacePathRegex:
        regex: "^/repository/apt-proxy/(.*)"
        replacement: "/repository/apt-proxy-${1}/"
    yum-proxy-centos:
      replacePathRegex:
        regex: "^/repository/yum-proxy/centos/(.*)"
        replacement: "/repository/yum-proxy-centos/$1"
    yum-proxy-centos-vault:
      replacePathRegex:
        regex: "^/repository/yum-proxy/centos-vault/(.*)"
        replacement: "/repository/yum-proxy-centos-vault/$1"
