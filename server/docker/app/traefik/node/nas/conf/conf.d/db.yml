http:
  routers:
    nexus:
      rule: Host(`nexus.czy21-internal.com`)
      service: nexus@docker
    nexus-repository:
      rule: Host(`nexus.czy21-internal.com`) && PathPrefix(`/repository`)
      service: nexus@docker
      middlewares:
        - raw-proxy
        - apt-proxy
        - yum-proxy
    registry:
      rule: Host(`registry.czy21-internal.com`)
      service: nexus@docker
      middlewares:
        - registry-hosted
    registry-proxy:
      rule: Host(`registry-proxy.czy21-internal.com`)
      service: nexus@docker
      middlewares:
        - registry-proxy-group
    ndisk:
      rule: Host(`ndisk.czy21-internal.com`)
      service: ndisk@docker
    es:
      rule: Host(`es.czy21-internal.com`)
      service: es-1@docker
    kb:
      rule: Host(`kb.czy21-internal.com`)
      service: es-1-kb@docker
    influxdb:
      rule: Host(`influxdb.czy21-internal.com`)
      service: influxdb@docker
    kafka-eagle:
      rule: Host(`ke.czy21-internal.com`)
      service: kafka-eagle@docker
    minio:
      rule: Host(`minio.czy21-internal.com`)
      service: minio-api@docker
    minio-web:
      rule: Host(`minio-web.czy21-internal.com`)
      service: minio-web@docker
    chat2db:
      rule: Host(`chat2db.czy21-internal.com`)
      service: chat2db@docker
    dbeaver:
      rule: Host(`dbeaver.czy21-internal.com`)
      service: dbeaver@docker
    redis-exporter:
      rule: Host(`redis-exporter-{{ param_cluster_name }}.czy21-internal.com`)
      service: redis-exporter@docker

  middlewares:
    force-https-header:
      headers:
        customRequestHeaders:
          X-Forwarded-Proto: "https"
    https-redirect:
      redirectScheme:
        scheme: https
        permanent: true
    raw-proxy:
      replacePathRegex:
        regex: "^/repository/raw-proxy/(.*)/"
        replacement: "/repository/raw-proxy-${1}/"
    apt-proxy:
      replacePathRegex:
        regex: "^/repository/apt-proxy/(.*)/"
        replacement: "/repository/apt-proxy-${1}/"
    yum-proxy:
      replacePathRegex:
        regex: "^/repository/yum-proxy/(.*)/"
        replacement: "/repository/yum-proxy-$1/"
    registry-hosted:
      replacePathRegex:
        regex: "^/"
        replacement: "/repository/docker-hosted/"
    registry-proxy-group:
      replacePathRegex:
        regex: "^/"
        replacement: "/repository/docker-proxy-group/"
