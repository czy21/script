http:
  routers:
    nexus:
      rule: Host(`nexus.czy21-internal.com`)
      service: nexus@docker
    nexus-repository:
      rule: Host(`nexus.czy21-internal.com`) && PathPrefix(`/repository`)
      service: nexus@docker
      middlewares:
        - raw-proxy
        - apt-proxy
        - yum-proxy
        - k8s-proxy
        - docker-ce-proxy
    registry:
      rule: Host(`registry.czy21-internal.com`)
      service: nexus@docker
      middlewares:
        - registry-hosted
    registry-proxy:
      rule: Host(`registry-proxy.czy21-internal.com`)
      service: nexus@docker
      middlewares:
        - registry-proxy-group

  middlewares:
    raw-proxy:
      replacePathRegex:
        regex: "^/repository/raw-proxy/(.*)/"
        replacement: "/repository/raw-proxy-${1}/"
    apt-proxy:
      replacePathRegex:
        regex: "^/repository/apt-proxy/(.*)/"
        replacement: "/repository/apt-proxy-${1}/"
    yum-proxy:
      replacePathRegex:
        regex: "^/repository/yum-proxy/(.*)/"
        replacement: "/repository/yum-proxy-$1/"
    k8s-proxy:
      replacePathRegex:
        regex: "^/repository/k8s-proxy/"
        replacement: "/repository/raw-proxy-kubernetes/"
    docker-ce-proxy:
      replacePathRegex:
        regex: "^/repository/docker-ce-proxy/"
        replacement: "/repository/raw-proxy-docker-ce/"
    registry-hosted:
      replacePathRegex:
        regex: "^/"
        replacement: "/repository/docker-hosted/"
    registry-proxy-group:
      replacePathRegex:
        regex: "^/"
        replacement: "/repository/docker-proxy-group/"