version: '3.7'

services:
  jira:
    build:
      context: ${GLOBAL_PWD_HOME}/compose/atlassian/image/
      dockerfile: ${GLOBAL_PWD_HOME}/compose/atlassian/image/jira-dockerfile
    container_name: jira
    privileged: true
    user: root
    ports:
      - "8100:8080"
    volumes:
      - ${GLOBAL_VOLUMES_DIR}/atlassian/jira/:/var/atlassian/jira/
      - ${GLOBAL_VOLUMES_DIR}/atlassian/jira/logs:/opt/atlassian/jira/logs
    environment:
      TZ: Asia/Shanghai
      CATALINA_OPTS: "-Xmx2G"
    restart: always


  confluence:
    build:
      context: ${GLOBAL_PWD_HOME}/compose/atlassian/image/
      dockerfile: ${GLOBAL_PWD_HOME}/compose/atlassian/image/confluence-dockerfile
    container_name: confluence
    privileged: true
    user: root
    ports:
      - "8101:8090"
    volumes:
      - ${GLOBAL_VOLUMES_DIR}/atlassian/confluence/:/var/atlassian/confluence/
      - ${GLOBAL_VOLUMES_DIR}/atlassian/confluence/logs:/opt/atlassian/confluence/logs
    environment:
      TZ: Asia/Shanghai
      CATALINA_OPTS: "-Xmx2G"
    restart: always


networks:
  default:
    external:
      name: local_default
